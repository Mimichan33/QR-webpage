<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>混雑傾向分析</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 20px;
      background: #f9f9f9;
    }

    h2 {
      margin-bottom: 20px;
    }

    .swiper {
      width: 100%;
      padding-bottom: 40px;
    }

    .swiper-slide {
      background: #fff;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    canvas {
      max-height: 300px;
    }

    .live-info {
      margin: 10px 0;
      font-size: 14px;
      color: #d93025;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <h2>混雑傾向分析</h2>

  <div class="swiper">
    <div class="swiper-wrapper" id="chartContainer">
      <!-- 曜日ごとのチャートがここに入る -->
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
  <script>
    const weekdays = ['日', '月', '火', '水', '木', '金', '土'];
    const today = new Date().getDay();

    const sampleData = Array.from({ length: 7 }, (_, i) => ({
      label: weekdays[i],
      data: Array.from({ length: 24 }, () => Math.floor(Math.random() * 100))
    }));

    const chartContainer = document.getElementById('chartContainer');

    sampleData.forEach((day, index) => {
      const slide = document.createElement('div');
      slide.className = 'swiper-slide';

      const liveIndex = new Date().getDay() === index ? new Date().getHours() : -1;

      const liveInfo = document.createElement('div');
      if (liveIndex >= 0) {
        liveInfo.className = 'live-info';
        liveInfo.textContent = 'ライブ：やや混んでいます';
      }

      const canvas = document.createElement('canvas');
      canvas.id = `chart-${index}`;
      slide.appendChild(document.createElement('h3')).textContent = `${day.label}曜日`;
      if (liveIndex >= 0) slide.appendChild(liveInfo);
      slide.appendChild(canvas);
      chartContainer.appendChild(slide);

      new Chart(canvas.getContext('2d'), {
        type: 'bar',
        data: {
          labels: Array.from({ length: 24 }, (_, i) => `${i}時`),
          datasets: [{
            label: '混雑度',
            data: day.data,
            backgroundColor: day.data.map((_, i) => i === liveIndex ? 'rgba(217, 48, 37, 0.8)' : 'rgba(66, 133, 244, 0.6)')
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: { stepSize: 20 }
            }
          }
        }
      });
    });

    new Swiper('.swiper', {
      slidesPerView: 1,
      spaceBetween: 20,
      initialSlide: today,
      pagination: { el: '.swiper-pagination', clickable: true },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev'
      }
    });
  </script>
</body>

</html>


